---
description: Create new draft components following Code-First-Design patterns
globs: ["**/*.tsx", "**/*.ts"]
---

# Creating draft components

## How the system works

The framework uses three registries that work together to manage components:

1. **`registry.ts`** - Lists components with metadata (name, path, category) for navigation. The `/proto` landing page reads this to show all available components.

2. **`component-registry.ts`** - Imports component code and defines default props. Used for validation and safe rendering with fallback behaviour.

3. **`COMPONENT_DEMOS` in `[slug]/page.tsx`** - Maps component slugs to React render functions. This is what actually renders the component preview when someone visits `/proto/components/<kebab-name>`.

When you create a component, you must update all three registries. Once complete, the component will appear in the design system at `/proto` and be viewable at `/proto/components/<kebab-name>`. Draft components can only be imported in `/proto` routes (ESLint enforces this).

## Steps

When creating a new UI component:

1) Create `components/draft/<Name>.tsx` (PascalCase, one export).

2) Use a `interface Props { ... }` and export `defaultProps`:
   ```ts
   export interface ExampleCardProps {
     title?: string;
     description?: string;
   }
   
   export const defaultProps: ExampleCardProps = {
     title: "Default Title",
     description: "Default description",
   };
   ```

3) Prefer Server Components; add `'use client'` only when required.

4) Compose from `components/ui/*` (shadcn primitives) where possible. Follow design principles in `design.mdc`.

5) Add demo renderer to `app/proto/components/[slug]/page.tsx` in the `COMPONENT_DEMOS` object:
   ```tsx
   // In app/proto/components/[slug]/page.tsx
   const COMPONENT_DEMOS: Record<string, () => React.ReactElement> = {
     '<kebab-name>': () => <Name {...defaultProps} />,
     // ... other demos
   };
   ```
   Note: The `[slug]` route is a dynamic route that handles all component demos. You don't create individual page files.

6) Register in `app/proto/_ds/registry.ts` under `draftComponents`:
   ```ts
   draftComponents: [
     { 
       name: "<Name>", 
       path: "/proto/components/<kebab-name>", 
       file: "components/draft/<Name>.tsx" 
     }
   ]
   ```

7) Add a demo config entry in `app/proto/_ds/component-registry.ts`:
   First import the component and defaultProps at the top of the file:
   ```ts
   import { <Name> } from '@/components/draft/<Name>';
   import { defaultProps } from '@/components/draft/<Name>';
   ```
   
   Then add the config entry to the `COMPONENT_CONFIGS` object:
   ```ts
   export const COMPONENT_CONFIGS: Record<string, ComponentDemoConfig> = {
     '<kebab-name>': {
       componentName: '<Name>',
       component: <Name>,
       defaultProps: defaultProps,
       fallbackMessage: '<Name> failed to render.',
     },
     // ... other configs
   };
   ```
