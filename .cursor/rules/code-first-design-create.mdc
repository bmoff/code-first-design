---
description: Create new draft components or prototypes following Code-First-Design patterns
alwaysApply: false
---

# Creating draft components and prototypes

**Before you start:** Read `code-first-design.mdc` to understand how the framework works, especially the "How it works" and "Components vs prototypes" sections. This rule helps you create either a component (individual UI piece) or a prototype (full application flow).

**⚠️ IMPORTANT:** You MUST ask planning questions BEFORE starting implementation. Do not jump straight to code. Clarify what the user wants first, then proceed.

---

## Planning questions (ask these first)

Before creating anything, ask these questions to understand what the user wants:

1. **What are you creating?**
   - Is it a **component** (like a button, card, or form - a single reusable piece)?
   - Or is it a **prototype** (a complete page or flow that shows multiple components working together)?

2. **What should it do?**
   - What's its purpose? What problem does it solve?
   - What should users be able to do with it?
   - What information does it need? (For components: what information does the component need to work? For prototypes: what pages or screens does it need?)

3. **What should it look like?**
   - Any specific design requirements?
   - Should it match existing components or have a new style?
   - Any accessibility needs to consider?

4. **How should it behave?**
   - Does it need to respond to user clicks or input? (If yes, it needs to be interactive)
   - Or is it just displaying information? (If yes, it can be simpler)

5. **If creating a prototype, also ask:**
   - What pages or screens does it need?
   - What components will it use? Are they new or do they already exist?
   - How should users navigate through it?

**Workflow:**
- If the user's request is vague, ask these questions explicitly
- If the user provides detailed information and you're confident about the answers, summarise your understanding and any assumptions you're making (keep it clear and concise)
- Only proceed to implementation steps once you have confirmed understanding

---

## Creating a component

A component is a single reusable UI piece (like a button, card, or form). Components are managed through three files that work together (see `code-first-design.mdc` for details).

### Steps

1) Create the component file at `components/draft/<Name>.tsx` (use PascalCase for the name, like `ExampleCard.tsx`).

2) Define what data the component accepts (these are called "props" - they're like settings or inputs the component needs to work):
   ```ts
   export interface ExampleCardProps {
     title?: string;        // Optional title text
     description?: string;  // Optional description text
   }
   
   // Default values to use when the component is shown in the design system
   export const defaultProps: ExampleCardProps = {
     title: "Default Title",
     description: "Default description",
   };
   ```

3) Build the component:
   - If it doesn't need interactivity (no clicks, no input, no changing data), keep it simple - don't add `'use client'` (this is called a Server Component, which is the default)
   - If it needs interactivity (buttons that do something, forms, data that changes when users interact), add `'use client'` at the very top of the file
   - Examples: A card that just displays text = no `'use client'`. A button that opens a modal = needs `'use client'`
   - Use existing components from `components/ui/*` where possible
   - Follow design principles in `design.mdc`

4) Add it to the demo system so it can be previewed. In `app/proto/components/[slug]/page.tsx`, add imports and demo:
   ```tsx
   import { <Name> } from '@/components/draft/<Name>';
   import { defaultProps } from '@/components/draft/<Name>';
   // If in subfolder:
   // import { <Name> } from '@/components/draft/<prototype-name>/<Name>';
   // import { defaultProps } from '@/components/draft/<prototype-name>/<Name>';
   
   const COMPONENT_DEMOS: Record<string, () => React.ReactElement> = {
     '<kebab-name>': () => <Name {...defaultProps} />,
     // ... other demos
   };
   ```
   Note: Use kebab-case for the name (like `example-card`). The `[slug]` route handles all component demos - you don't create individual page files.

5) Register it in `app/proto/_ds/registry.ts` under `draftComponents`:
   ```ts
   draftComponents: [
     { 
       name: "<Name>", 
       path: "/proto/components/<kebab-name>", 
       file: "components/draft/<Name>.tsx"  // If in subfolder: "components/draft/<prototype-name>/<Name>.tsx"
     }
   ]
   ```
   Note: If the component is in a subfolder (e.g., `components/draft/<prototype-name>/<Name>.tsx`), include the full path in the `file` property.

6) Add it to `app/proto/_ds/component-registry.ts`:
   First import the component and its default props at the top:
   ```ts
   import { <Name> } from '@/components/draft/<Name>';
   import { defaultProps } from '@/components/draft/<Name>';
   // If in subfolder:
   // import { <Name> } from '@/components/draft/<prototype-name>/<Name>';
   // import { defaultProps } from '@/components/draft/<prototype-name>/<Name>';
   ```
   
   Then add it to the `COMPONENT_CONFIGS` object:
   ```ts
   export const COMPONENT_CONFIGS: Record<string, ComponentDemoConfig> = {
     '<kebab-name>': {
       componentName: '<Name>',
       component: <Name>,
       defaultProps: defaultProps,
       fallbackMessage: '<Name> failed to render.',
     },
     // ... other configs
   };
   ```

Once complete, the component will appear in the design system at `/proto` and be viewable at `/proto/components/<kebab-name>`. Draft components can only be imported in `/proto` routes - the code checker (ESLint) will prevent them from being used in production code.

---

## Creating a prototype

A prototype is a complete page or flow that shows how multiple components work together. Prototypes are simpler than components - they only need to be registered in one place (`registry.ts`), not three.

### Steps

1) Create the prototype page at `app/proto/prototypes/<kebab-name>/page.tsx`:

```tsx
'use client'; // Add this if the page needs interactivity (buttons, forms, changing data), otherwise remove it

import { ProtoHeader } from '@/app/proto/_components/ProtoHeader';
// Import your components here

export default function <Name>Page() {
  return (
    <>
      <ProtoHeader
        component={{
          name: '<Name>',
          type: 'Prototype',
        }}
      />
      {/* Your prototype content here */}
    </>
  );
}
```

2) Create any new components needed:
   - List all components required for this prototype
   - Check if they already exist or need to be created
   - If new components are needed, create them using the component steps above (steps 1-6 in "Creating a component" section)
   - New components should live in `components/draft/<prototype-name>/` to keep them organised
   - **Important**: ALL components created in `components/draft/` MUST be registered in the design system as draft components. Follow steps 4-6 in the "Creating a component" section to register them properly.

3) Build the prototype page:
   - Import your components (draft components can be imported freely in `/proto` routes)
   - Structure the layout and flow
   - Add any necessary interactivity or data that changes (this is called "state" - like tracking if a form is submitted, or what the user has selected)

4) Register it in `app/proto/_ds/registry.ts` under the `prototypes` array:

```ts
prototypes: [
  { 
    name: "<Name>", 
    path: "/proto/prototypes/<kebab-name>", 
    description: "Optional description of what this prototype demonstrates"
  },
  // ... other prototypes
]
```

Note: Prototypes only need `registry.ts` - they don't need `component-registry.ts` or `COMPONENT_DEMOS` because they're full pages, not component demos.

5) If you need multiple pages or nested routes (e.g., `/prototypes/workspace/[id]`), create additional route files:
   - `app/proto/prototypes/<name>/[id]/page.tsx` for dynamic routes
   - `app/proto/prototypes/<name>/layout.tsx` for shared layouts

6) Test the prototype by visiting `/proto/prototypes/<kebab-name>` in your browser.

### Example structure

For a prototype called "Analyst Workspace":
- Route: `app/proto/prototypes/analyst-workspace/page.tsx`
- Components: `components/draft/analyst-workspace/WorkspaceLayout.tsx`, `AnalystSidebar.tsx`, etc.
- Registry entry: `{ name: "Analyst Workspace", path: "/proto/prototypes/analyst-workspace", description: "AI-powered research workspace" }`
